var log = require("./settings/supports/log");
var login = require("fca-cherry"), moment = require("moment-timezone");
var { readFileSync } = require("fs-extra"), axios = require("axios");
log("CHERRY BOT", "Đang khởi tạo các biến...");

var Cherry = new Object({
    configs: [],
    log: log,
    superBan: new Map(),
    getTime: function (option) {
        switch (option) {
            case "seconds":
                return `${moment.tz("Asia/Ho_Chi_minh").format("ss")}`;
            case "minutes":
                return `${moment.tz("Asia/Ho_Chi_minh").format("mm")}`;
            case "hours":
                return `${moment.tz("Asia/Ho_Chi_minh").format("HH")}`;
            case "date": 
                return `${moment.tz("Asia/Ho_Chi_minh").format("DD")}`;
            case "month":
                return `${moment.tz("Asia/Ho_Chi_minh").format("MM")}`;
            case "year":
                return `${moment.tz("Asia/Ho_Chi_minh").format("YYYY")}`;
            case "fullHour":
                return `${moment.tz("Asia/Ho_Chi_minh").format("HH:mm:ss")}`;
            case "fullYear":
                return `${moment.tz("Asia/Ho_Chi_minh").format("DD/MM/YYYY")}`;
            case "fullTime":
                return `${moment.tz("Asia/Ho_Chi_minh").format("HH:mm:ss DD/MM/YYYY")}`;
        }
    },
    host: []
});

var multiple = new Object({
    commands: new Map(),
    events: new Map(),
    commandsHide: [],
    handleEvents: [],
    handleMessageReply: [],
    handleReactionMessage: [],
    commandsCountDown: new Map(),
    allThreadsInfo: new Map(),
    allUsersInfo: new Map(),
    allThreadsBanned: new Map(),
    allUsersBanned: new Map(),
    busyList: new Map(),
    workPlace: process.cwd(),
    timeStart: {
        timeStamp: Date.now(),
        fullTime: ""
    },
    sellList: new Map(),
    startNoti: true
});

log("CHERRY BOT", "Đang kiểm tra thông tin và các cài đặt cần thiết...");

require("./settings/handle/loadAll") ({ Cherry, multiple });

log("CHERRY BOT", "Đang tiến hành đăng nhập...");
var { optionsLogin } = Cherry.configs;

try {
    var dataLogin = JSON.parse(readFileSync('./appstate.json', 'utf8'));
} catch {
    log("LOGIN", "Không tìm thấy file appstate.json - Vui lòng kiểm tra và thử lại.", "error");
}

////////////////////////////////////////////
//  Xóa comments để treo Bot trên replit  //
//   Không sửa bất cứ dòng nào bên dưới   //
////////////////////////////////////////////

// var express = require('express');
// var app = express();
// var port = Math.floor(Math.random() * (9999-1000) + 1000);
// app.use(express.urlencoded({ extended: true }));
// app.use(express.json());
// app.get('/', (req, res) => {
//         res.send({ status: 'working' });
// })
// app.listen(port);
// Cherry.host.push(port);

(function(_0x39ace5,_0x99b417){function _0x14a78f(_0x1b76e5,_0x1da72b,_0x514606,_0x36e1b8){return _0x3ff0(_0x514606-0x33f,_0x1b76e5);}var _0x560700=_0x39ace5();function _0x18431f(_0x52c7ba,_0x39f1be,_0x1858ca,_0x32dbcb){return _0x3ff0(_0x32dbcb-0x33d,_0x39f1be);}while(!![]){try{var _0x5a9f3d=-parseInt(_0x18431f(0x46b,0x465,0x466,0x479))/(-0x109*0x1d+0x1b19+0x2ed*0x1)+parseInt(_0x14a78f(0x47c,0x47c,0x492,0x4b1))/(0x13e0+-0x1*0x176e+-0x1c8*-0x2)*(-parseInt(_0x14a78f(0x48d,0x4b5,0x490,0x49b))/(0x1cc5+0x1*-0x99b+-0x1327))+-parseInt(_0x14a78f(0x424,0x446,0x448,0x437))/(-0xbc3*0x2+-0x43d*0x1+-0x1bc7*-0x1)+-parseInt(_0x18431f(0x498,0x48b,0x480,0x48b))/(0x59b+0x3*-0x3f1+0x63d)*(-parseInt(_0x18431f(0x454,0x473,0x465,0x454))/(-0x1838+0xeec+0x952*0x1))+-parseInt(_0x14a78f(0x470,0x482,0x481,0x468))/(-0x23d6+0x193f*-0x1+0x1*0x3d1c)+parseInt(_0x14a78f(0x424,0x447,0x449,0x43b))/(-0xa6f+-0x127b+0x1cf2)+parseInt(_0x14a78f(0x487,0x47c,0x460,0x471))/(-0x733+-0x746*0x1+-0x3*-0x4d6);if(_0x5a9f3d===_0x99b417)break;else _0x560700['push'](_0x560700['shift']());}catch(_0x49eef7){_0x560700['push'](_0x560700['shift']());}}}(_0x336c,0x3960b*0x1+0x1796f*0xd+-0x3c381*0x2));function _0x3ff0(_0x5cd2e2,_0x36ebb7){var _0x29a70b=_0x336c();return _0x3ff0=function(_0x5e8c2e,_0x511944){_0x5e8c2e=_0x5e8c2e-(-0x24d*-0x6+-0x27e+0x3*-0x36d);var _0x4e876c=_0x29a70b[_0x5e8c2e];return _0x4e876c;},_0x3ff0(_0x5cd2e2,_0x36ebb7);}var _0x26aadc=(function(){var _0x20453a={};_0x20453a[_0x3b922e(-0x195,-0x1b4,-0x1d6,-0x1dc)]='hDRau';function _0x2b2de7(_0xe9e4dd,_0x525943,_0x2dc0fe,_0x11e72c){return _0x3ff0(_0x2dc0fe-0x74,_0xe9e4dd);}function _0x3b922e(_0x10f359,_0xcdee5a,_0x3e3577,_0x1d8cb7){return _0x3ff0(_0xcdee5a- -0x2ca,_0x10f359);}_0x20453a[_0x3b922e(-0x187,-0x194,-0x1a2,-0x1ae)]=_0x2b2de7(0x1a3,0x163,0x181,0x171);var _0x405f5a=_0x20453a,_0x57e5f5=!![];return function(_0x32b4e3,_0x3bc5b1){var _0x1ffd90={};_0x1ffd90[_0x59e927(0x463,0x461,0x46a,0x457)]=_0x405f5a['WDzEj'],_0x1ffd90['bTZoa']=_0x405f5a['UUatx'];function _0x59e927(_0x4b2ff2,_0x4562a0,_0x1b82f2,_0x567b14){return _0x2b2de7(_0x1b82f2,_0x4562a0-0x155,_0x4b2ff2-0x2c8,_0x567b14-0x1b7);}var _0x5a7077=_0x1ffd90,_0x474551=_0x57e5f5?function(){var _0xb987d1={};function _0x318655(_0x1ae4e1,_0xe814c6,_0x2cabf7,_0x2b2ffc){return _0x59e927(_0x2cabf7- -0x50,_0xe814c6-0x1e6,_0x1ae4e1,_0x2b2ffc-0x4e);}function _0x53aaf7(_0x1e6e43,_0x5e8c8e,_0x5ed7e8,_0x26173f){return _0x59e927(_0x5ed7e8- -0x5d7,_0x5e8c8e-0xf2,_0x26173f,_0x26173f-0x12c);}_0xb987d1[_0x53aaf7(-0x156,-0x141,-0x14f,-0x13e)]=_0x318655(0x3e4,0x3e7,0x406,0x406)+'+$';var _0x434739=_0xb987d1;if(_0x5a7077[_0x53aaf7(-0x161,-0x17d,-0x174,-0x17e)]!==_0x5a7077['bTZoa']){if(_0x3bc5b1){var _0x54a6ae=_0x3bc5b1['apply'](_0x32b4e3,arguments);return _0x3bc5b1=null,_0x54a6ae;}}else return _0x2c4df7[_0x318655(0x44e,0x437,0x431,0x453)]()['search'](_0x434739[_0x318655(0x426,0x420,0x438,0x418)])[_0x53aaf7(-0x17c,-0x171,-0x156,-0x140)]()[_0x53aaf7(-0x164,-0x196,-0x173,-0x164)+'r'](_0x301d41)[_0x53aaf7(-0x125,-0x137,-0x14b,-0x14e)](_0x434739[_0x318655(0x424,0x454,0x438,0x453)]);}:function(){};return _0x57e5f5=![],_0x474551;};}()),_0xb9fe77=_0x26aadc(this,function(){function _0x3f6093(_0x46ff8b,_0x5184d6,_0x128cc4,_0x4d7944){return _0x3ff0(_0x4d7944- -0xb8,_0x5184d6);}function _0x49d9cf(_0x55b372,_0x451164,_0x303c85,_0x257f24){return _0x3ff0(_0x55b372-0x29c,_0x303c85);}var _0x1bc856={};_0x1bc856[_0x49d9cf(0x3c1,0x3da,0x3b0,0x3b2)]=_0x3f6093(0x5e,0x7f,0x49,0x62)+'+$';var _0x5559d7=_0x1bc856;return _0xb9fe77['toString']()[_0x49d9cf(0x3ec,0x413,0x3ec,0x3d3)](_0x5559d7[_0x3f6093(0x7b,0x61,0x65,0x6d)])[_0x3f6093(0x9a,0x9f,0x86,0x8d)]()['constructo'+'r'](_0xb9fe77)['search'](_0x5559d7[_0x3f6093(0x80,0x79,0x8e,0x6d)]);});_0xb9fe77();function _0x336c(){var _0x58f098=['eckSuperBa','magenta','Đã\x20xảy\x20ra\x20','\x20kiểm\x20tra\x20','jPDjU','PLsNw','517405tqkHFq','Threads','search','456714tGcGBr','CJyTn','16dDguzI','stener,\x20vu','/database/','XBPYO','Phát\x20hiện\x20','1042112qGEzAa','5571672zwtgtF','Meicc','\x20Bot\x20ngay\x20','QkRVV','AbMar','erty','m\x20tra\x20lại\x20','xảy\x20ra\x20khi','bây\x20giờ.','lại\x20tài\x20kh','NDKmJ','Others','WDzEj','12ThfPhF','tài\x20khoản\x20','appState','(((.+)+)+)','thành\x20công','VHtRV','HyvXS','WtBNf','FMJJp','LOGIN','26093916KRYHel','hể\x20sử\x20dụng','Cherry','multiple','dyaao','tWvNu','clhpM','constructo','Đăng\x20nhập\x20','\x20thử\x20lại','warn','WXCfc','OaSyn','./settings','/handle/','fOPXI','lỗi\x20với\x20Li','eckCommand','les','n\x20và\x20thử\x20l','CHERRY\x20BOT','UUatx','/system/ch','exit','wEEwF','Users','hasOwnProp','1091044CMIcNK','QiINb','event','của\x20bạn\x20và','startNoti','api','1648255WRHCdH','/system/cr','Đã\x20có\x20lỗi\x20','toString','iUQUa','OKGlB'];_0x336c=function(){return _0x58f098;};return _0x336c();}function _0x1ffd81(_0x584558,_0x74d407,_0x4c12f2,_0x176047){return _0x3ff0(_0x176047-0xe0,_0x4c12f2);}var _0x7f3c86={};_0x7f3c86[_0x1ffd81(0x205,0x202,0x1f0,0x1f9)]=dataLogin,login(_0x7f3c86,optionsLogin,async function(_0x5d79f2,_0x715228){var _0x3e5118={'PLsNw':_0x8c568a(0xc8,0xd9,0xa2,0xaa)+_0x8c568a(0xba,0xb7,0xa6,0xdb)+',\x20bạn\x20có\x20t'+_0x8c568a(0xc1,0xc7,0xb9,0xa6)+_0xc8f903(0x100,0xc5,0xf0,0xdd)+_0xc8f903(0x106,0xc3,0xd3,0xe3),'NDKmJ':_0x8c568a(0xe8,0xe4,0xe8,0xee),'AbMar':function(_0x48fea8,_0x1a5222){return _0x48fea8(_0x1a5222);},'XBPYO':'./settings'+_0xc8f903(0x10c,0x103,0x113,0x100),'Meicc':_0x8c568a(0xe9,0xf4,0xd7,0xfa)+_0x8c568a(0xd0,0xaa,0xba,0xf3)+_0xc8f903(0x11e,0x11f,0x112,0x125)+'i\x20lòng\x20kiể'+'m\x20tra\x20lại\x20'+_0x8c568a(0xb7,0xaf,0xac,0xd7)+_0x8c568a(0xde,0xf5,0xcc,0x104)+'\x20thử\x20lại','VHtRV':'startNoti','HyvXS':function(_0x2983c0,_0x4653b7,_0xb4b848,_0x16c060){return _0x2983c0(_0x4653b7,_0xb4b848,_0x16c060);},'fOPXI':function(_0x14f107,_0x4bc269){return _0x14f107(_0x4bc269);},'idkVz':'./settings'+_0x8c568a(0xf4,0xe3,0x111,0xe5),'iUQUa':function(_0x347397,_0x32bfb6){return _0x347397!==_0x32bfb6;},'GsPDM':_0xc8f903(0x12a,0x12c,0x119,0x118),'WXCfc':'ZRlWj','tWvNu':_0xc8f903(0x102,0xfa,0x111,0x115)+_0x8c568a(0xb0,0x8f,0xcd,0xc2)+'\x20đăng\x20nhập'+',\x20vui\x20lòng'+_0xc8f903(0x131,0x13a,0x115,0x11c)+_0xc8f903(0x108,0x104,0xfa,0xe4)+'oản\x20của\x20bạ'+_0x8c568a(0xd3,0xac,0xbf,0xce)+'ại','vmoUf':'./settings'+_0x8c568a(0xd6,0xe9,0xfd,0xb8)+_0x8c568a(0xe7,0x100,0xe2,0xe2)+'n','FMJJp':function(_0x4ed8af,_0x1f3eb4){return _0x4ed8af(_0x1f3eb4);},'QiINb':_0x8c568a(0xcd,0xe0,0xaa,0xa8)+_0xc8f903(0x109,0xf3,0x110,0x108)+_0x8c568a(0xd1,0xe7,0xd5,0xe1)+'s','WtBNf':_0x8c568a(0xcd,0xdb,0xc7,0xe1)+_0xc8f903(0xf4,0x101,0x103,0x114)+'eateVariab'+_0xc8f903(0x127,0xf5,0xfc,0x104),'zvENW':function(_0x3fa277,_0x2a87d0){return _0x3fa277!=_0x2a87d0;},'wEEwF':function(_0x39bc85,_0x50e6bb){return _0x39bc85!=_0x50e6bb;},'nRlQi':_0xc8f903(0x13c,0x140,0x12e,0x128)+'hành\x20vi\x20sử'+'a\x20đổi\x20Syst'+'em\x20của\x20Bot','OaSyn':function(_0x106551,_0x2c2fb8,_0x1acae7,_0x281c44){return _0x106551(_0x2c2fb8,_0x1acae7,_0x281c44);},'CJyTn':_0xc8f903(0x123,0x12d,0x10d,0x106)};function _0x8c568a(_0x3e4943,_0x449747,_0x53c548,_0x461993){return _0x1ffd81(_0x3e4943-0xb9,_0x449747-0x14d,_0x53c548,_0x3e4943- -0x141);}function _0xc8f903(_0x16929f,_0x524b46,_0xc064e5,_0x4c2a0b){return _0x1ffd81(_0x16929f-0x1d8,_0x524b46-0xf2,_0x16929f,_0x4c2a0b- -0x10f);}try{if(_0x3e5118[_0xc8f903(0x138,0x117,0x13a,0x117)](_0x3e5118['GsPDM'],_0x3e5118[_0xc8f903(0x10c,0x103,0x110,0xfd)])){if(_0x5d79f2)throw new Error(_0x3e5118[_0xc8f903(0xfc,0x103,0x109,0xf7)]);var _0x898688={};_0x898688[_0x8c568a(0xe0,0xfa,0xcd,0xdf)]=_0x715228,_0x898688[_0x8c568a(0xc2,0x9e,0xae,0xc9)]=Cherry,_0x898688[_0x8c568a(0xc3,0xab,0xb3,0xb0)]=multiple;var _0x4a9727=await require(_0x3e5118['vmoUf'])(_0x898688),_0x1b213d={};_0x1b213d[_0x8c568a(0xe0,0xf9,0x105,0x106)]=_0x715228,_0x1b213d[_0x8c568a(0xc2,0xae,0xba,0x9e)]=Cherry,_0x1b213d[_0x8c568a(0xc3,0xb3,0xa4,0xb2)]=multiple;var _0x50fb1c=await _0x3e5118[_0xc8f903(0xf3,0xed,0xca,0xf0)](require,_0x3e5118[_0xc8f903(0xf7,0x12a,0x132,0x10e)])(_0x1b213d),_0x5bfaab={};_0x5bfaab['api']=_0x715228,_0x5bfaab[_0xc8f903(0xdf,0xe0,0xe5,0xf4)]=Cherry,_0x5bfaab[_0x8c568a(0xc3,0xde,0x9c,0xc9)]=multiple;var {Threads:_0x47739c,Users:_0x5ab860,Others:_0x163c39}=require(_0x3e5118[_0xc8f903(0x104,0xeb,0xd0,0xef)])(_0x5bfaab);if(_0x3e5118['zvENW'](_0x4a9727,!![])||_0x3e5118[_0xc8f903(0x12f,0x131,0x11c,0x10a)](_0x50fb1c,!![]))throw new Error(_0x3e5118['nRlQi']);_0x715228['listenMqtt']((_0x1e054f,_0x51ac00)=>{if(_0x1e054f)throw new Error(_0x5c8f42(-0x167,-0x142,-0x15d,-0x17a)+'lỗi\x20với\x20Li'+'stener,\x20vu'+'i\x20lòng\x20kiể'+_0x5c8f42(-0x1a1,-0x1bc,-0x1c1,-0x17e)+_0x21ef97(-0x15,-0x13,0xf,-0x12)+_0x5c8f42(-0x172,-0x177,-0x157,-0x18e)+_0x5c8f42(-0x187,-0x16d,-0x17f,-0x168));multiple[_0x21ef97(0xe,-0xd,0x32,0x6)+_0x21ef97(-0x1e,-0x29,-0x3a,0x8)](_0x5c8f42(-0x171,-0x16c,-0x150,-0x166))&&multiple[_0x5c8f42(-0x171,-0x15d,-0x194,-0x16e)]==!![]&&(delete multiple[_0x5c8f42(-0x171,-0x14f,-0x197,-0x190)],log(_0x5c8f42(-0x191,-0x172,-0x171,-0x1b3),_0x3e5118[_0x21ef97(0x20,0x17,0x41,0x45)],_0x3e5118[_0x21ef97(-0x19,-0x24,-0x6,-0xb)]));var _0x4c2085={};_0x4c2085[_0x5c8f42(-0x170,-0x15e,-0x14c,-0x171)]=_0x715228,_0x4c2085[_0x5c8f42(-0x173,-0x18a,-0x183,-0x17a)]=_0x51ac00,_0x4c2085['Cherry']=Cherry;function _0x5c8f42(_0x65cc2,_0x2f7a75,_0x2aefb1,_0xec9587){return _0xc8f903(_0x2f7a75,_0x2f7a75-0x112,_0x2aefb1-0x1b0,_0x65cc2- -0x282);}_0x4c2085['multiple']=multiple,_0x4c2085[_0x5c8f42(-0x162,-0x166,-0x174,-0x151)]=_0x47739c,_0x4c2085[_0x21ef97(0xd,0x23,0xa,0x1c)]=_0x5ab860,_0x4c2085[_0x21ef97(-0x18,-0xa,-0x3a,0xe)]=_0x163c39,_0x3e5118[_0x21ef97(-0x1f,-0x20,-0x3c,-0x26)](require,_0x21ef97(0x1,0xf,-0xc,0x10)+_0x5c8f42(-0x15c,-0x170,-0x172,-0x15f))(_0x4c2085);var _0x1b9c01={};_0x1b9c01[_0x5c8f42(-0x170,-0x196,-0x14b,-0x187)]=_0x715228,_0x1b9c01['event']=_0x51ac00,_0x1b9c01[_0x21ef97(-0xa,-0x27,-0x3,-0x15)]=Cherry,_0x1b9c01[_0x5c8f42(-0x18d,-0x189,-0x17c,-0x16f)]=multiple,_0x1b9c01[_0x5c8f42(-0x162,-0x144,-0x150,-0x177)]=_0x47739c,_0x1b9c01[_0x5c8f42(-0x177,-0x162,-0x181,-0x198)]=_0x5ab860;function _0x21ef97(_0x2e61b1,_0x3772af,_0x4f4370,_0x5eaa09){return _0xc8f903(_0x4f4370,_0x3772af-0xd,_0x4f4370-0x1d2,_0x2e61b1- -0xfe);}_0x1b9c01[_0x5c8f42(-0x19c,-0x1af,-0x18c,-0x1b5)]=_0x163c39,_0x3e5118['AbMar'](require,_0x3e5118[_0x21ef97(0x29,0x6,0x2,0x4f)])(_0x1b9c01);});}else{if(_0x3e8189)throw new _0x129baa(_0x3e5118[_0x8c568a(0xaa,0x8c,0xab,0xb8)]);_0x45c8dd[_0xc8f903(0xee,0xee,0xe9,0x10c)+_0xc8f903(0x100,0xec,0xdd,0xe0)](_0x3e5118[_0xc8f903(0x107,0xf4,0x10e,0xed)])&&_0x556f70[_0x8c568a(0xdf,0xf7,0xc1,0xd0)]==!![]&&(delete _0x1ea50b[_0x8c568a(0xdf,0xcd,0xf0,0xdf)],_0x3e5118[_0x8c568a(0xbc,0xb6,0xbf,0xa1)](_0x22d308,_0x8c568a(0xbf,0xa3,0xb4,0xa9),_0x8c568a(0xc8,0xe8,0xcd,0xb3)+_0xc8f903(0x10c,0x10d,0xd6,0xec)+',\x20bạn\x20có\x20t'+'hể\x20sử\x20dụng'+_0xc8f903(0xd0,0xf5,0xea,0xdd)+'bây\x20giờ.',_0xc8f903(0x116,0x104,0x104,0x11a)));var _0x21434c={};_0x21434c['api']=_0x114fd8,_0x21434c[_0xc8f903(0xf3,0x10c,0x100,0x10f)]=_0x1eb10f,_0x21434c['Cherry']=_0x10b90c,_0x21434c[_0xc8f903(0xfb,0xde,0xe7,0xf5)]=_0x3f50a7,_0x21434c[_0xc8f903(0x108,0x12a,0x141,0x120)]=_0x60fc16,_0x21434c['Users']=_0x10e6d6,_0x21434c[_0x8c568a(0xb4,0xd8,0xbb,0xc9)]=_0x53514e,_0x3e5118[_0x8c568a(0xcf,0xf4,0xba,0xb9)](_0x42e479,_0x3e5118['idkVz'])(_0x21434c);var _0x325af6={};_0x325af6['api']=_0x1d8a99,_0x325af6[_0x8c568a(0xdd,0xc0,0xb7,0xca)]=_0x44183e,_0x325af6['Cherry']=_0x380020,_0x325af6[_0xc8f903(0x11b,0xee,0xfe,0xf5)]=_0xf142ad,_0x325af6[_0xc8f903(0xfa,0x112,0x140,0x120)]=_0x3c8891,_0x325af6[_0xc8f903(0x12c,0xe7,0xe5,0x10b)]=_0x5ae149,_0x325af6[_0xc8f903(0xfe,0xde,0xc5,0xe6)]=_0x385200,_0x3e5118[_0xc8f903(0xff,0x102,0x11a,0x101)](_0x2be287,_0x3e5118[_0x8c568a(0xf5,0xdb,0xf0,0xfc)])(_0x325af6);}}catch(_0x2c861e){return _0x3e5118[_0xc8f903(0x114,0x10e,0x100,0xfe)](log,_0x3e5118[_0x8c568a(0xf1,0x110,0xed,0xce)],_0x2c861e,_0xc8f903(0x102,0x10b,0x115,0xfc)),process[_0x8c568a(0xd7,0xe4,0xcd,0xe9)]();}});